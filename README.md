# Dungeon Gunner

一个基于Unity开发的地牢探险射击游戏，采用程序化地牢生成算法。

## 项目概述

Dungeon Gunner是一款2D地牢探险游戏，玩家需要在程序化生成的地牢中战斗、探索和收集宝藏。游戏采用了先进的节点图驱动地牢生成算法，确保每次游戏体验都是独特的。

## 核心功能

### 地牢生成系统
- **节点图驱动**：使用预定义的房间节点图作为地牢逻辑结构
- **房间模板系统**：通过房间模板提供具体的房间布局
- **门道连接系统**：确保房间之间的正确连接
- **重叠检测算法**：避免房间冲突

### 玩家系统
- 角色控制和移动
- 生命值系统
- 武器和战斗系统

## 开发工具

### 动画引用名称修改器

**位置**：`工具 > 动画引用名称修改器`

**功能**：修改动画剪辑中的指定引用名称，将引用路径中的名字从A改为B

**使用方法**：
1. 在Unity编辑器中，点击菜单栏：`工具 > 动画引用名称修改器`
2. 拖入包含动画的GameObject到"目标物体"字段
3. 输入要替换的引用名称（原引用名称A → 新引用名称B）
4. 选择是否搜索子物体动画
5. 点击"预览修改"查看将要修改的动画引用
6. 确认无误后点击"执行修改"

**使用场景**：
- 修复因物体重命名导致的动画引用丢失
- 批量更新动画路径中的特定名称
- 重构项目时统一修改动画引用

**注意事项**：
- 动画引用修改会直接修改资源文件，无法撤销
- 建议在修改前备份项目或使用版本控制
- 工具会精确匹配路径中的名称，请确保输入正确

**支持的动画类型**：
- Animator Controller中的动画剪辑
- Animation组件中的动画剪辑
- 子物体中的所有动画组件

**技术原理**：
- 通过EditorCurveBinding分析动画路径
- 使用字符串替换修改路径引用
- 支持普通曲线和对象引用曲线的修复

### 房间节点编辑器

**位置**：`Window > 地牢编辑 > 房间节点编辑器`

**功能**：可视化编辑地牢房间的连接关系和逻辑结构

## 项目结构

```
Assets/
├── CourseAssets/          # 课程资源（纹理、音效、材质等）
├── Prefabs/              # 预制体
│   ├── Dungeon/          # 地牢相关预制体
│   ├── GameResources/    # 游戏资源预制体
│   └── Player/           # 玩家相关预制体
├── Scenes/               # 场景文件
├── Scripts/              # 脚本文件
│   ├── Dungeon/          # 地牢生成相关脚本
│   ├── Player/           # 玩家相关脚本
│   ├── GameManager/      # 游戏管理器
│   ├── Health/           # 生命值系统
│   ├── NodeGraph/        # 节点图系统
│   ├── Utilities/        # 工具类和编辑器工具
│   └── Enums/            # 枚举定义
├── ScriptableObjectAssets/ # ScriptableObject资源
└── Tilemap/              # 瓦片地图资源
```

## 开发环境

- **Unity版本**：2022.3 LTS 或更高版本
- **渲染管线**：Universal Render Pipeline (URP)
- **平台**：PC (Windows/Mac/Linux)

## 核心设计模式

- **单例模式**：GameManager、DungeonBuilder等核心管理器
- **组件模式**：基于Unity的MonoBehaviour组件化架构
- **ScriptableObject模式**：用于数据驱动的配置和资源管理
- **观察者模式**：事件系统和状态管理

## 性能优化

- **对象池**：频繁实例化的游戏对象
- **批处理优化**：材质和纹理的合理使用
- **LOD系统**：复杂3D模型的细节级别管理
- **物理优化**：简化碰撞网格和时间步长调整

## 贡献指南

1. 遵循Unity的组件化架构
2. 使用描述性的变量和函数名称
3. 遵循C#编码规范（PascalCase用于公共成员，camelCase用于私有成员）
4. 为复杂逻辑添加详细注释
5. 使用Unity的Debug类进行日志记录
6. 优先使用Unity内置功能和工具

## 许可证

本项目仅用于学习和教育目的。

## 更新日志

### v1.3.0 (当前版本)
- 重构工具为"动画引用名称修改器"
- 专注于动画引用路径的修改功能
- 移除GameObject重命名功能，专注于动画引用处理
- 优化用户界面，更清晰地说明工具用途
- 改进错误提示和用户反馈
- 增强预览功能，显示搜索的引用名称

### v1.2.0
- 升级为带动画的物体名称修改器
- 支持同时重命名GameObject和修复动画引用
- 添加自动填充当前物体名称功能
- 支持Unity撤销系统
- 递归处理子物体重命名

### v1.1.0
- 新增动画引用修复工具
- 完善项目文档和使用说明
- 优化代码结构和注释

### v1.0.0
- 基础地牢生成系统
- 玩家控制和移动
- 房间节点编辑器
- 基础游戏框架